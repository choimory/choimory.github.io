---
title: "DB 복구 전략(Backup and Recovery)"
date: 2025-10-30T00:00:00
toc: true
toc_sticky: true
categories:
    - DB
tags:
    - Backup
    - DevOps
---

# Intro

- *DB 복구 전략(Backup and Recovery)*는 데이터베이스에서 예상치 못한 장애나 데이터 손실이 발생했을 때, 데이터를 안전하게 복구하고 시스템을 정상적으로 운영할 수 있도록 하는 절차와 방법을 말한다.
- 데이터베이스 관리에서는 **백업**과 **복구**가 중요한 요소이며, 이를 통해 데이터의 안전성과 가용성을 보장할 수 있다.

---

# **백업(Backup)**

- **백업**은 데이터베이스의 데이터를 **복사하여 저장**하는 과정이다.
- 백업은 여러 유형과 방식으로 이루어지며, 이를 통해 데이터 손실 시 시스템을 복구할 수 있다.
- 백업은 복구 계획의 첫 번째 단계로, 데이터의 안전성을 보장하는 데 필수적이다.

## 백업의 종류

### **전체 백업(Full Backup)**:

- 데이터베이스의 **모든 데이터를 복사**하는 백업 방식이다.
- 전체 데이터를 주기적으로 백업하여, 데이터 손실 시 백업 시점의 상태로 복원할 수 있다.
- **장점**: 백업 파일만 있으면 데이터베이스를 **완전하게 복구**할 수 있다.
- **단점**: 데이터 양이 많을 경우 백업 시간과 저장 공간이 많이 소요된다.

### **차등 백업(Differential Backup)**:

- **가장 최근의 전체 백업** 이후에 변경된 데이터만 백업하는 방식이다.
- 백업의 크기와 시간이 전체 백업보다 작으며, 복구 시 전체 백업과 가장 최신의 차등 백업을 사용하여 복구한다.
- **장점**: 전체 백업보다 백업 속도가 빠르고 저장 공간이 절약된다.
- **단점**: 차등 백업이 누적될수록 백업 파일의 크기가 커질 수 있다.

### **증분 백업(Incremental Backup)**:

- **가장 최근의 백업 이후 변경된 데이터**만 백업하는 방식이다.
- 증분 백업은 매번 전체 데이터를 백업할 필요 없이, 변화된 부분만을 백업하여 시간을 절약할 수 있다.
- **장점**: 가장 적은 저장 공간과 시간이 소요된다.
- **단점**: 복구할 때는 전체 백업과 모든 증분 백업을 순차적으로 적용해야 하므로, 복구 시간이 길어질 수 있다.

### **트랜잭션 로그 백업(Transaction Log Backup)**:

- 데이터베이스의 모든 변경 사항이 기록되는 **트랜잭션 로그**를 백업하는 방식이다.
- 주기적으로 트랜잭션 로그를 백업하여 데이터베이스의 **세부적인 복구**가 가능하다.
- **장점**: 트랜잭션 로그를 사용하면 **특정 시점**까지 복구할 수 있으며, 정밀한 복구가 가능하다.
- **단점**: 트랜잭션 로그 크기가 커질 수 있고, 로그 파일이 손상되면 복구가 어려울 수 있다.

## 백업 전략

### **주기적인 전체 백업** + **증분 백업**:

- 주기적으로 전체 백업을 수행한 후, 그 사이에 증분 백업을 수행하는 방식이다.
- 이렇게 하면 전체 데이터 복구가 가능하면서도 백업 시간과 저장 공간을 절약할 수 있다.

### **전체 백업** + **차등 백업**:

- 전체 백업을 주기적으로 수행하고, 그 이후에 차등 백업을 수행하는 방식이다.
- 차등 백업은 복구 시 전체 백업과 함께 사용되므로 복구 시간이 비교적 짧다.

### **전체 백업** + **트랜잭션 로그 백업**:

- 트랜잭션 로그 백업을 주기적으로 수행하여, **특정 시점으로의 복구**가 필요한 경우에 유용하다.
- 전체 백업과 트랜잭션 로그를 함께 사용하여 복구하는 방식이다.

---

# **복구(Recovery)**

- **복구**는 데이터베이스 장애나 손실이 발생했을 때, 백업된 데이터를 사용해 데이터베이스를 **정상 상태로 복구**하는 과정이다.
- 복구 전략은 장애의 원인과 데이터 손실의 범위에 따라 다양한 방법으로 이루어진다.

## 복구의 유형

### **전체 복구(Full Recovery)**:

- 전체 백업을 사용해 데이터베이스를 **완전한 상태**로 복구하는 방식이다.
- 전체 백업 파일을 이용해 모든 데이터를 복원하며, 그 이후 트랜잭션 로그나 증분 백업을 적용해 복구한다.
- **사용 시기**: 데이터베이스 전체에 문제가 생겼을 때 사용된다.

### **포인트 인 타임 복구(Point-in-Time Recovery)**:

- 트랜잭션 로그 백업을 이용해 **특정 시점까지** 데이터를 복구하는 방식이다.
- 예를 들어, 잘못된 데이터 수정이 일어난 시점 직전으로 복구할 때 사용한다.
- **사용 시기**: 특정 시간이나 사건에 의한 데이터 손상 시, 해당 시점으로 복구하고 싶을 때 사용된다.

### **부분 복구(Partial Recovery)**:

- 데이터베이스의 특정 파티션이나 일부만 복구하는 방식이다.
- 전체 데이터베이스를 복구할 필요 없이, 손상된 부분만 복구한다.
- **사용 시기**: 특정 테이블, 파티션, 또는 데이터 파일에 문제가 발생했을 때 사용된다.

### **트랜잭션 복구(Transaction Recovery)**:

- 데이터베이스가 비정상적으로 종료되었을 때, **트랜잭션 로그**를 사용해 진행 중이던 트랜잭션을 완료하거나 롤백하는 방식이다.
- 완료되지 않은 트랜잭션은 롤백하고, 완료된 트랜잭션은 커밋하여 데이터 일관성을 유지한다.
- **사용 시기**: 시스템 장애나 비정상 종료 시 사용된다.

---

# **복구 전략 선택**

- 복구 전략을 선택할 때는 다음 요소를 고려해야 한다.

## **복구 목표 시간(RTO, Recovery Time Objective)**:

- **복구 목표 시간**은 데이터베이스가 장애로부터 복구되기까지 허용 가능한 최대 시간이다.
- RTO가 짧을수록 더 신속한 복구가 요구되며, 이를 위해서는 **증분 백업**이나 **로그 백업**을 활용할 수 있다.

## **복구 목표 시점(RPO, Recovery Point Objective)**:

- **복구 목표 시점**은 데이터베이스가 복구될 때 허용 가능한 **데이터 손실량**을 의미한다.
- 예를 들어, RPO가 10분이라면 장애 발생 후 10분 전까지의 데이터는 복구되어야 한다.
- RPO가 짧을수록 자주 백업을 수행해야 한다.

## **데이터 중요도**:

- 데이터베이스의 중요도에 따라 백업 빈도와 복구 방법이 달라진다.
- 중요한 데이터베이스는 더 빈번한 백업과 세밀한 복구 전략이 필요하다.

## **백업 저장 공간**:

- 백업 파일이 차지하는 **저장 공간**을 고려해야 한다.
- 증분 백업이나 트랜잭션 로그 백업을 통해 저장 공간을 절약할 수 있다.

## **운영 중 백업**:

- 데이터베이스 운영 중에도 **백업을 수행**할 수 있는 기술이 필요하다.
- 백업 중에도 데이터베이스가 가동 중이기 때문에 백업과 운영 간의 성능 영향을 최소화해야 한다.

---

# **백업 및 복구 도구**

- 다양한 데이터베이스 관리 시스템(DBMS)은 각기 다른 백업 및 복구 도구를 제공한다.

## **Oracle RMAN**:

- Oracle 데이터베이스에서 백업과 복구를 관리하는 도구.
- 전체 백업, 차등 백업, 증분 백업을 지원하며, 손쉬운 자동 복구 기능을 제공한다.

## **MySQL Dump**:

- MySQL에서 데이터를 백업할 때 사용되는 명령어 기반의 백업 도구.
- 전체 백업과 일부 데이터를 선택적으로 백업할 수 있다.

## **SQL Server Backup**:

- Microsoft SQL Server는 전체, 차등, 트랜잭션 로그 백업을 지원하며, 데이터베이스의 고급 복구 기능을 제공한다.

---

# 정리

- **DB 복구 전략**은 데이터베이스의 가용성을 높이고 데이터 손실을 최소화하는 중요한 과정이다.
- 백업 전략과 복구 전략을 잘 설계하면 데이터베이스 장애 시 빠르고 효율적으로 복구할 수 있다.
- **전체 백업**, **증분 백업**, **차등 백업** 등의 백업 방식을 적절히 혼합하여 사용하고, **포인트 인 타임 복구**나 **트랜잭션 복구**를 통해 장애 시점에 따른 복구 전략을 세우는 것이 중요하다.
- 이를 통해 예상치 못한 시스템 장애나 데이터 손실 상황에서도 데이터베이스의 신뢰성과 가용성을 유지할 수 있다.